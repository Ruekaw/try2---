# Q1 基础结果分析（DWTS 粉丝投票反推）

本文档用于把 Q1 的核心产出与结论“打包成可直接搬进论文的段落/要点”。

- 结果目录（本次 quick run）：[outputs/q1_mcmc_quick_20260202](../outputs/q1_mcmc_quick_20260202)
- 主要输出文件：
  - [outputs/q1_mcmc_quick_20260202/fan_vote_estimates_long.csv](../outputs/q1_mcmc_quick_20260202/fan_vote_estimates_long.csv)
  - [outputs/q1_mcmc_quick_20260202/fan_vote_estimates_wide.csv](../outputs/q1_mcmc_quick_20260202/fan_vote_estimates_wide.csv)
  - [outputs/q1_mcmc_quick_20260202/inference_summary.json](../outputs/q1_mcmc_quick_20260202/inference_summary.json)
  - [outputs/q1_mcmc_quick_20260202/diagnostic_report.txt](../outputs/q1_mcmc_quick_20260202/diagnostic_report.txt)

---

## 1. 模型目标与可辨识性说明（写进假设很关键）

题目要求“估算每位选手在参赛周内的粉丝投票”。节目真实每周总票数 $T_t$ 未公开且数据中没有任何锚点，因此仅凭“评委分数 + 淘汰结果”一般无法同时辨识 $T_t$ 与各选手票数。

本方案的推断对象是每周投票份额（vote share）：

- 对每个赛季-周 $t$，在当周参赛的 $n_t$ 名选手上估计 $v_t=(v_{1,t},\dots,v_{n_t,t})$，满足 $v_{i,t}\ge 0$ 且 $\sum_i v_{i,t}=1$。
- 因此输出是“相对票数/份额”，可用于推导“谁更可能靠粉丝票存活/淘汰”，但不声称能恢复真实总票数 $T_t$。

---

## 2. 约束与赛制处理（Q1 用到的观测信息）

对每个赛季-周，已知：

- 评委总分（由数据汇总得到）
- 当周淘汰结果（从数据的 last_week_scored/result_type 等字段识别）

并按赛制构造淘汰约束：

- 百分比制（Season 3–27）：综合得分 $S_i = \text{JudgePct}_i + v_i$，得分越低越差，被淘汰者应落在 bottom-$k$。
- 排名制（Season 1–2, 28+）：综合得分为“排名和”，越大越差，被淘汰者应落在 bottom-$k$。
- Season 28+ 允许“评委救人”：被淘汰者只需位于 bottom-2（而非必须是绝对垫底）。
- 决赛周按名次链式约束（冠军应优于亚军、亚军优于季军…），用违约函数刻画。

采样采用 M-H MCMC，在单纯形上对 $v_t$ 做贝叶斯后验采样；默认使用软约束（违约越大，后验惩罚越强），避免数据清洗/规则细节不完备时直接无解。

---

## 3. 输出字段解释（long 表）

[fan_vote_estimates_long.csv](../outputs/q1_mcmc_quick_20260202/fan_vote_estimates_long.csv) 为“选手-周”粒度，关键字段：

- `fan_vote_mean/std/ci_lower/ci_upper`：$v_{i,t}$ 的后验均值、标准差、95%可信区间
- `ppc_consistency`：该周后验样本中“完全满足淘汰/名次约束”的比例（见下节）
- `mean_violation`：该周后验样本违约程度的均值
- `acceptance_rate`：M-H 接受率
- `converged`：采样质量判定（基于 ESS 与接受率，见下节）

注意：同一周的 `ppc_consistency/acceptance_rate/converged` 在 long 表中会对该周所有选手重复出现。

---

## 4. 评价指标口径（写作建议：要把口径说清）

### 4.1 一致性：PPC Consistency

将“是否符合淘汰/名次规则”视为后验预测检验（Posterior Predictive Check）：

- 对每个后验样本 $v^{(s)}$，判断其是否满足当周规则；满足记为 1，不满足记为 0。
- `ppc_consistency = mean(满足指示变量)`，可解释为

$$
P(\text{规则满足} \mid \text{数据与先验})
$$

这不是“准确率”，更像“模型在自身假设下，解释真实淘汰机制的概率强度”。

### 4.2 不确定性：可信区间宽度与 SNR

- `ci_width = Q_{97.5}(v_{i,t})-Q_{2.5}(v_{i,t})`：绝对不确定性
- `snr = mean/std`：相对信噪比（越大越稳定）

### 4.3 采样质量：converged（ESS 口径）


- 对 MCMC 样本计算 ESS（Geyer 初始正序列估计器）；
- 使用自适应阈值：$\text{ESS} > \max(20, \min(100, 0.02\times n_{diag}))$；
- 高维单纯形下不要求全维度通过，而要求至少 80% 的维度通过（`ess_fraction=0.8`）。

---

## 5. 总体结果概览（quick run）

来自 [inference_summary.json](../outputs/q1_mcmc_quick_20260202/inference_summary.json)：

- 推断赛季数：34
- 推断周数：261
- 收敛（采样质量达标）的周数：201
- 收敛率：77.01%
- 平均 PPC（按“周”不加权口径）：0.773（std 约 0.174）
- 平均接受率：0.446

来自 [diagnostic_report.txt](../outputs/q1_mcmc_quick_20260202/diagnostic_report.txt)：

- 平均 PPC（按“选手-周”加权口径）：0.755（std 约 0.189，min 约 0.265）
- SNR 均值：约 1.963
- 95% CI 宽度均值：约 0.279

口径提醒：`inference_summary.json` 的 mean_ppc 是“每周平均”（不随当周人数加权）；`diagnostic_report.txt` 是对 long 表直接取均值，会按当周参赛人数隐式加权，两者出现轻微差异是正常的。

---

## 6. 结构性发现（可直接写进论文的结论点）

### 6.1 多淘汰周显著降低 PPC

在 quick run 中，按 `elimination_count` 分组：

- 单淘汰周（201周）：mean PPC ≈ 0.771，min ≈ 0.305
- 双淘汰周（23周）：mean PPC ≈ 0.637，min ≈ 0.265

解释建议：双淘汰/特殊规则周通常更复杂，单一的“bottom-k 约束”更容易与真实节目流程不完全一致，因此 PPC 会系统性下降。

### 6.2 百分比制赛季的 PPC 明显更低

按赛制分组（quick run）：

- percent（193周）：mean PPC ≈ 0.702，min ≈ 0.265
- rank（68周）：mean PPC ≈ 0.974，min ≈ 0.768

解释建议：百分比制下“综合得分=评委百分比+粉丝份额”对 $v$ 的可行域限制更敏感；此外 percent 赛季覆盖范围更大（3–27），包含更多特殊周/多淘汰周。

### 6.3 决赛周 PPC 更高

- 非决赛周（229周）：mean PPC ≈ 0.761
- 决赛周（32周）：mean PPC ≈ 0.856

直观原因：决赛周采用名次链式约束（相对顺序），相对“精确指定谁在 bottom-k”通常更宽松/更容易满足。

---

## 7. PPC 最低周（用于举例说明“难周/特殊周”）

以下为 quick run 中 PPC 最低的 12 个周（均为 percent 赛季，且多为双淘汰/早周；括号内为当周被淘汰者）：

- S7W1 ppc≈0.265（Jeffrey Ross; Ted McGinley）
- S20W2 ppc≈0.305（Redfoo）
- S25W2 ppc≈0.329（Barbara Corcoran; Debbie Gibson）
- S24W7 ppc≈0.343（Nancy Kerrigan; Nick Viall）
- S23W4 ppc≈0.346（Babyface; Vanilla Ice）
- S26W1 ppc≈0.358（Jamie Anderson; Johnny Damon）
- S26W2 ppc≈0.397（Arike Ogunbowale; Kareem Abdul-Jabbar）
- S22W7 ppc≈0.399（Kim Fields; Von Miller）
- S10W2 ppc≈0.442（Shannen Doherty）
- S27W7 ppc≈0.450（DeMarcus Ware; John Schneider）
- S15W2 ppc≈0.451（Joey Fatone）
- S9W1 ppc≈0.458（Ashley Hamiliton; Macy Gray）

写作建议：不要把“PPC 低”一概解释为“争议选手导致”。更稳的说法是：PPC 低往往对应“规则复杂周（多淘汰/早周/特殊流程）+ 先验假设偏差”。争议选手只可能是原因之一。

---

## 8. 时间平滑（temporal prior）对 PPC 的影响（证据来自灵敏度分析）

时间平滑参数越强（temporal_alpha 越大），在多个代表性赛季会显著降低 mean PPC（同时接受率也下降）。例如在 [outputs/q1_mcmc/temporal_alpha_sensitivity_summary.csv](../outputs/q1_mcmc/temporal_alpha_sensitivity_summary.csv) 中：

- S9：mean PPC 从 0.707（无平滑）下降到 0.474（alpha=100）
- S15：0.702 → 0.457
- S23：0.683 → 0.455

解释建议：时间平滑引入“投票惯性”，当现实中存在突发爆火/舆情事件导致的票数突变时，惯性先验可能会与淘汰约束冲突，从而降低 PPC。


---

## 10. 局限性与后续改进（建议写在 Q1 末尾）

- 本方法主要恢复 $v_{i,t}$（份额），不声称恢复真实总票数 $T_t$。
- hit_rate 在当前实现中几乎恒为 1（并列与约束自洽会抬高该指标），建议作为辅助参考，不作为主要结论。
- PPC<1 不等价于“模型失败”，而是提示：规则细节未完全建模、存在数据噪声、或先验假设（如时间平滑）与现实存在偏差。建议在论文中用“复杂周/特殊周”示例解释。
